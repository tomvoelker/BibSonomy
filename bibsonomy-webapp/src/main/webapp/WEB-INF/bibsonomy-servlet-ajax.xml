<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:util="http://www.springframework.org/schema/util"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
	                    http://www.springframework.org/schema/beans/spring-beans.xsd
	                    http://www.springframework.org/schema/util 
	                    http://www.springframework.org/schema/util/spring-util-2.5.xsd">


	<!--+
		| url mapping for ajax request: /ajax/*
		+-->
	<bean id="ajaxUrlMapping" parent="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
		<property name="urlMap">
			<map merge="true">
				<entry key="/generalAjax">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="generalAjaxController"/>
						<property name="allowedFields">
							<list>
								<value>action</value>
								<value>pageURL</value>
								<value>q</value>
								<value>requestedUser</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/additionalURLs">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="additionalURLController" />
						<property name="allowedFields">
							<list>
								<value>ckey</value>
								<value>url</value>
								<value>text</value>
								<value>hash</value>
								<value>action</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/cv">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="cvController" />
						<property name="allowedFields">
							<list>
								<value>pubFormat</value>
								<value>ckey</value>
								<value>layout</value>
								<value>renderOptions</value>
								<value>wikiText</value>
								<value>requestedGroup</value>
								<value>text</value>
								<value>hash</value>
								<value>action</value>
							</list>
						</property>
					</bean>
				</entry>
				
				<entry key="/ajax/documents">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="documentsController" />
						<property name="allowedFields">
							<list>
								<value>intraHash</value>
								<value>fileName</value>
								<value>newFileName</value>
								<value>fileHash</value>
								<value>temp</value>
								<value>ckey</value>
								<value>action</value>
								<value>file</value>
								<value>fileID</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/autocomplete">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="autocompleteController"/>
						<property name="allowedFields">
							<list>
								<value>search</value>
								<value>format</value>
							</list>
						</property>
					</bean>
				</entry>
				<!-- get recommendations for user -->
				<entry key="/ajax/getBookmarkRecommendedTags">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="ajaxGetBookmarkRecommendedTagsController" />
						<property name="allowedFields" ref="bookmarkRequestParameters" />
					</bean>
				</entry>
				<entry key="/ajax/getPublicationRecommendedTags">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="ajaxGetPublicationRecommendedTagsController" />
						<property name="allowedFields" ref="publicationRequestParameters" />
					</bean>
				</entry>
				<entry key="/ajax/addItemRecommenderFeedback">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="ajaxItemRecommenderFeedbackController" />
						<property name="allowedFields" >
							<list>
								<value>intraHash</value>
								<value>action</value>
								<value>userName</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/handleGroupShare">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="groupShareAjaxController" />
						<property name="allowedFields" >
							<list>
								<value>requestedGroup</value>
								<value>action</value>
								<value>forward</value>
								<value>ckey</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/handleUserRelation">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="userRelationAjaxController" />
						<property name="allowedFields" >
							<list>
								<value>requestedUserName</value>
								<value>action</value>
								<value>forward</value>
								<value>relationTags</value>
								<value>userRelation</value>
								<value>ckey</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/pickUnpickPost">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="clipboardController" />
						<property name="allowedFields" >
							<list>
								<value>hash</value>
								<value>action</value>
								<value>user</value>
								<value>ckey</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/pickUnpickConcept">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="conceptController" />
						<property name="allowedFields" >
							<list>
								<value>tag</value>
								<value>action</value>
								<value>ckey</value>
								<value>forward</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/goldstandards/relation">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="editGoldstandardRelationController"/>
						 <property name="allowedFields">
							<list>
								<value>action</value>
								<value>hash</value>
								<value>references</value>
								<value>relation</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/usersearch">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="userSearchController"/>
						<property name="allowedFields">
							<list>
								<value>search</value>
								<value>limit</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/comments">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="commentController"/>
						<property name="allowedFields">
							<list>
								<value>hash</value>
								<value>postUserName</value>
								<value>intraHash</value>
								<value>discussionItem.text</value>
								<value>discussionItem.hash</value>
								<value>discussionItem.anonymous</value>
								<value>discussionItem.parentHash</value>
								<value>abstractGrouping</value>
	  							<value>groups</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/reviews">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="reviewController"/>
						<property name="allowedFields">
							<list>
								<value>hash</value>
								<value>postUserName</value>
								<value>intraHash</value>
								<value>discussionItem.rating</value>
								<value>discussionItem.text</value>
								<value>discussionItem.hash</value>
								<value>discussionItem.anonymous</value>
								<value>abstractGrouping</value>
								<value>groups</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/updateprivatenote">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="privatenoteController" />
						<property name="allowedFields">
							<list>
								<value>intraHash</value>
								<value>ckey</value>
								<value>privateNote</value>
							</list>
						</property>
					</bean>
				</entry>
			</map>
		</property>
	</bean>
	

	<!--+
		  | ajax controller
	   	+-->
	<bean id="ajaxController" class="org.bibsonomy.webapp.controller.ajax.AjaxController" abstract="true">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="requestLogic" ref="requestLogic" />
		<property name="responseLogic" ref="responseLogic"/>
	</bean>
	
	<bean id="discussionItemAjaxController" class="org.bibsonomy.webapp.controller.ajax.DiscussionItemAjaxController" abstract="true" parent="ajaxController">
		<property name="pingback" ref="pingback"/>
	</bean>
	
	<bean id="generalAjaxController" class="org.bibsonomy.webapp.controller.ajax.GeneralAjaxController" scope="request" parent="ajaxController" />	
	<bean id="editGoldstandardRelationController" class="org.bibsonomy.webapp.controller.ajax.EditGoldstandardRelationController" parent="ajaxController" scope="request" />
	
	<bean id="commentController" class="org.bibsonomy.webapp.controller.ajax.CommentAjaxController" parent="discussionItemAjaxController" scope="request" />
	<bean id="reviewController" class="org.bibsonomy.webapp.controller.ajax.ReviewAjaxController" parent="discussionItemAjaxController" scope="request" />
	
	<bean id="autocompleteController" class="org.bibsonomy.webapp.controller.actions.PublicationAutocompleteController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="scrapers" ref="kdeScraperChain"/>
	</bean>
	
	<bean id="additionalURLController" class="org.bibsonomy.webapp.controller.ajax.AdditionalURLController" scope="request" parent="ajaxController" />
	
	<bean id="cvController" class="org.bibsonomy.webapp.controller.ajax.AjaxCvController" scope="request" parent="ajaxController">
		<property name="wikiRenderer" ref="wikiRenderer"/>
		<property name="notLoggedInUserLogic" ref="notLoggedInUserLogic"/>
	</bean>
	
	<bean id="documentsController" class="org.bibsonomy.webapp.controller.ajax.DocumentsController" scope="request" parent="ajaxController">
		<property name="fileLogic" ref="fileLogic" />
		<property name="messageSource" ref="messageSource"/>
	</bean>
	
	<!-- controller for handling recommendation requests -->
	<bean id="ajaxTagsRecommendationsController" class="org.bibsonomy.webapp.controller.ajax.RecommendationsAjaxController" abstract="true" parent="ajaxController">
		<!-- used for accessing spam informations -->
		<property name="adminLogic" ref="adminLogic"/>
		<property name="recommender"	ref="multiplexingTagRecommender" />
		<!-- tag recommender used for spammer -->
		<property name="spamTagRecommender" ref="spamTagRecommender" />
		<property name="recommendationRenderer" ref="recommendedTagRenderer" />
	</bean>
	
	<bean id="spamTagRecommender" class="org.bibsonomy.recommender.RecommendationServiceWrapper">
		<constructor-arg ref="jensRecommender" />
	</bean>
	
	<bean id="ajaxItemRecommenderFeedbackController" class="org.bibsonomy.webapp.controller.ajax.ItemRecommenderFeedbackController" scope="request" parent="ajaxController">
		<property name="multiplexingBibTexRecommender" ref="multiplexingBibTexRecommender" />
		<property name="multiplexingBookmarkRecommender" ref="multiplexingBookmarkRecommender" />
	</bean>
	
	
	<bean id="userSearchController" class="org.bibsonomy.webapp.controller.ajax.UserSearchController" scope="request" parent="ajaxController" />
	
	<bean id="ajaxGetBookmarkRecommendedTagsController" class="org.bibsonomy.webapp.controller.ajax.GetBookmarkRecommendedTagsController" scope="request" parent="ajaxTagsRecommendationsController" />
	
	<bean id="ajaxGetPublicationRecommendedTagsController" class="org.bibsonomy.webapp.controller.ajax.GetPublicationRecommendedTagsController" scope="request" parent="ajaxTagsRecommendationsController" />
	
	<bean id="userRelationAjaxController" class="org.bibsonomy.webapp.controller.ajax.UserRelationAjaxController" scope="request" parent="ajaxController" />
	
	<bean id="groupShareAjaxController" class="org.bibsonomy.webapp.controller.ajax.GroupShareAjaxController" scope="request" parent="ajaxController" />
	
	<bean id="clipboardController" class="org.bibsonomy.webapp.controller.ajax.ClipboardController" scope="request" parent="ajaxController" />
	
	<bean id="conceptController" class="org.bibsonomy.webapp.controller.ajax.ConceptController" scope="request" parent="ajaxController" />
	
	<bean id="privatenoteController" class="org.bibsonomy.webapp.controller.ajax.PrivateNoteAjaxController" scope="request" parent="ajaxController" />
	
</beans>