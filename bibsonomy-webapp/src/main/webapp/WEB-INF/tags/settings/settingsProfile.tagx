<jsp:root version="2.0"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:jsp="http://java.sun.com/JSP/Page"
  xmlns:c="http://java.sun.com/jsp/jstl/core"
  xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
  xmlns:layout="urn:jsptagdir:/WEB-INF/tags/layout"
  xmlns:fn="http://java.sun.com/jsp/jstl/functions"
  xmlns:form="http://www.springframework.org/tags/form"
  xmlns:spring="http://www.springframework.org/tags"
  xmlns:errors="urn:jsptagdir:/WEB-INF/tags/errors"
  xmlns:mtl="urn:jsptld:/WEB-INF/taglibs/mytaglib.tld">
  
  <jsp:directive.attribute name="command"  type="org.bibsonomy.webapp.command.BaseCommand" required="true"/>
  
	<!-- ############################################# profile tab ############################################# -->	
		<fmt:message var="saveChanges" key="settings.saveChanges" />
		<fmt:message var="male" key="settings.male"/>
		<fmt:message var="female" key="settings.female"/>
		<fmt:message var="public" key="settings.public"/>
		<fmt:message var="private" key="settings.private"/>
		<fmt:message var="friends" key="settings.friends"/>
		
		<!-- display potential errors -->
		<errors:global errors="${errors}"/>
		
        <p>
        	<fmt:message key="settings.profileInfo"><fmt:param><a href="/foaf/user/${mtl:encodeURI(user.name)}">/foaf/user/<c:out value="${user.name}"/></a></fmt:param><fmt:param><fmt:message key="settings.profileViewableFor"/></fmt:param></fmt:message>
        </p>
		
		<form:form name="account" method="post" action="/updateUserProfile">		
	
        <h2><fmt:message key="settings.generalInformation" /></h2>		
    
    	<div id="fsform">
    	<fieldset class="fsOuter" style="background-color:#EEEEEE; padding: 5px; border:1px solid #006699; position:relative;">
		<table>
		  <div class="fsRow">
		  <tr>
		  	<!-- <td><form:label cssClass="fsLabel" path="user.name" ><fmt:message key="settings.username"/></form:label></td> -->
		    <td><fmt:message key="settings.username"/></td>
		    <td><c:out value="${command.user.name}"/></td>
		  </tr>
		  </div>
		  <div class="fsRow">
		  <tr>
		    <td><fmt:message key="settings.realname"/></td>
		    <td><form:input path="user.realname"/><div class="dissError" style="position:relative"><form:errors path="user.realname" /></div>
		    </td>
		  </tr>
		  </div>
		  <div class="fsRow">
		  <tr>
		    <td><fmt:message key="settings.gender"/></td>
		    <td><form:select path="user.gender">
		    		<form:option label="${male}" value="m"/>
		    		<form:option label="${female}" value="f"/>
		    </form:select>
		    <div class="dissError" style="position:relative"><form:errors path="user.gender" /></div>
		    </td>
		  </tr>
		  </div>
		  <div class="fsRow">
		  <tr>
		    <td><fmt:message key="settings.birthday"/></td>
		    <td><form:input path="user.birthday"/>
		    <div class="dissError" style="position:relative"><form:errors path="user.birthday" /></div>
		    format: YYYY-MM-DD</td>
		  </tr>
		  </div>
		  <div class="fsRow">
		  <tr>
		    <td><fmt:message key="settings.place"/></td>
		    <td><form:input path="user.place"/></td>
		  </tr>
		  </div>
		  <div class="fsRow">
		  <tr>
		    <td><fmt:message key="settings.profileViewableFor"/></td>
		    <td><form:select path="group">
		    	<form:option label="${public}" value="public"/>
		    	<form:option label="${private}" value="private"/>
		    </form:select>
		    <div class="dissError" style="position:relative"><form:errors path="group" /></div>
			</td>
		  </tr>
		  </div>
		</table>
		</fieldset>
		</div>
		
		<h2><fmt:message key="settings.contact" /></h2>		
		
		<div id="fsform">
    	<fieldset class="fsOuter" style="background-color:#EEEEEE; padding: 5px; border:1px solid #006699; position:relative;">
		<table>
		  <div class="fsRow">
		  <tr>
		    <td><fmt:message key="settings.email"/></td>
		    <td><form:input path="user.email"/>
                <fmt:message key="settings.mandatory"/>
                <div class="dissError" style="position:relative"><form:errors path="user.email" /></div>
            </td>
		  </tr>
		  </div>
		  <div class="fsRow">
		  <tr>
		    <td><fmt:message key="settings.homepage"/></td>
		    <td><form:input path="user.homepage"/>
		    	<div class="dissError" style="position:relative"><form:errors path="user.homepage" /></div>
		    </td>
		  </tr>
		  </div>
		  <div class="fsRow">
		  <tr>
		    <td>openURL</td>
		    <td><form:input path="user.openURL"/>
		    	<fmt:message key="settings.openURLDescription"><fmt:param><a href="http://www.exlibrisgroup.com/sfx_openurl.htm">openURL</a></fmt:param></fmt:message>
		        <div class="dissError" style="position:relative"><form:errors path="user.openURL" /></div>
		    </td>
		  </tr>
		  </div>
		</table>
		</fieldset>
		</div>
		
		<h2><fmt:message key="settings.aboutMe"/></h2>
		
		<div id="fsform">
    	<fieldset class="fsOuter" style="background-color:#EEEEEE; padding: 5px; border:1px solid #006699; position:relative;">
		<table>
		  <div class="fsRow">
		  <tr>
		    <td><fmt:message key="settings.profession"/></td>
		    <td><form:input path="user.profession"/></td>		        
		  </tr>
		  </div>
		  <div class="fsRow">
		  <tr>
		    <td><fmt:message key="settings.scientificInterests"/></td>
		    <td><form:textarea cols="30" rows="4" path="user.interests"/></td>
		  </tr>
		  </div>
		  <div class="fsRow">
		  <tr>
		    <td><fmt:message key="settings.hobbies"/></td>
		    <td><form:textarea cols="30" rows="4" path="user.hobbies" /></td>
		  </tr>
		  </div>
		</table>
		</fieldset>
		</div>
		
		<h2><fmt:message key="settings.myFriends"/></h2>
		
		
		<div id="fsform">
    	<fieldset class="fsOuter" style="background-color:#EEEEEE; padding: 5px; border:1px solid #006699; position:relative;">		  
		<table>	
		<div class="fsRow">	
		<tr>
			<td><fmt:message key="settings.friendOf"/></td>
			<td>
				<c:if test="${empty command.userFriends}"><fmt:message key="settings.noFriends"/></c:if>
				<ul>
					<c:forEach var="myfr1" items="${command.userFriends}">			
		 				<li><a href="/user/${mtl:encodeURI(myfr1.name)}"><c:out value="${myfr1.name}"/></a></li>		 		
					</c:forEach>
				</ul>
			</td>
		</tr>
		</div>
		<div class="fsRow">		
		<tr>
			<td><fmt:message key="settings.myFriendsAre"><fmt:param><a href="/friends"><fmt:message key="friends"/></a></fmt:param></fmt:message></td>
			<td>
				<c:if test="${empty command.friendsOfUser}">
				<fmt:message key="settings.noFriends"/> (
				<fmt:message key="settings.addFriendsNow">
					<fmt:param>
						<a href="/friends">
							<fmt:message key="settings.add"/>
						</a>
					</fmt:param>
				</fmt:message>) 
				</c:if>
				<ul>
					<c:forEach var="myfr2" items="${command.friendsOfUser}">			
		 				<li><a href="/user/${mtl:encodeURI(myfr2.name)}"><c:out value="${myfr2.name}"/></a></li>		 		
					</c:forEach>
				</ul>
			</td>
		</tr>
		</div>

		</table>
		</fieldset>
		</div>
		
		<p>
		</p>
		
		<input type="hidden" name="action" value="update"/>
		<input type="hidden" name="ckey" value="${ckey}"/>
	    <input type="hidden" name="selTab" value="0"/>
		
		<table>
			<tr>
				<td><input type="submit" value="${saveChanges}"/></td>
			</tr>
		</table>
	</form:form>	
</jsp:root>