<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:util="http://www.springframework.org/schema/util"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
	                    http://www.springframework.org/schema/beans/spring-beans.xsd
	                    http://www.springframework.org/schema/util 
	                    http://www.springframework.org/schema/util/spring-util-2.5.xsd">


	<bean id="controllerBase" class="org.bibsonomy.webapp.util.spring.controller.MinimalisticControllerSpringWrapper" abstract="true">
		<property name="allowedFields" ref="allowedFields"/>
		<property name="disallowedFields" ref="disallowedFields"/>
	</bean>
	

	<bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
		<property name="interceptors">
			<list>
				<ref local="localeChangeInterceptor"/>
				<!-- 
   		         Wraps the request into a context and provides access to loginUser, ckey, etc.
		         Will be put into the command by the controllerBase
		        -->
				<ref local="requestWrapperContextInterceptor"/>
			</list>
		</property>
		<property name="urlMap">
			<map>
				<entry key="/homepage">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="homepageController"/>
					</bean>
				</entry>
				<entry key="/settingsnew">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="settingsPageController"/>
						<property name="allowedFields">
							<list>
								<value>selTab</value>
								<value>ckey</value>
								<value>grouping</value>
								<value>importType</value>
								<value>overwrite</value>
								<value>file</value> 
								<value>tagBoxStyle</value>
								<value>tagSort</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/user">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="userPageController"/>
					</bean>
				</entry>	
				<entry key="/relations">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="userRelationsController"/>
					</bean>
				</entry>				
				<entry key="/export">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="exportPageController"/>
					</bean>
				</entry>				
				<entry key="/groups">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="groupsPageController"/>
					</bean>
				</entry>	
				<entry key="/group">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="groupPageController"/>
					</bean>
				</entry>	
				<entry key="/viewable">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="viewablePageController"/>
					</bean>
				</entry>
				<entry key="/tag">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="tagPageController"/>
					</bean>
				</entry>
				<entry key="/author">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="authorPageController"/>
					</bean>
				</entry>
				<entry key="/authors">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="authorsPageController"/>
					</bean>
				</entry>				
				<entry key="/concept">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="conceptPageController"/>
					</bean>
				</entry>	
				<entry key="/friends">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="friendsPageController"/>
					</bean>
				</entry>	
				<entry key="/friend">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="friendPageController"/>
					</bean>
				</entry>
				<entry key="/bibtexkey">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="bibtexkeyPageController"/>
					</bean>
				</entry>		
				<entry key="/url">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="urlPageController"/>
					</bean>
				</entry>	
				<entry key="/bibtex">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="bibtexPageController"/>
					</bean>
				</entry>
				<entry key="/basket">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="basketPageController"/>
					</bean>
				</entry>				
				<entry key="/unapi">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="UnAPIController"/>
						<property name="allowedFields">
							<list>
								<value>id</value>
								<value>format</value>
							</list>
						</property>
					</bean>
				</entry>			 
				<entry key="/redirect">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="RedirectController"/>
						<property name="allowedFields">
							<list>
								<value>myPage</value>
								<value>search</value>
								<value>scope</value>
								<value>requUser</value>
								<value>url</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/search">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="searchPageController"/>
					</bean>
				</entry>
				<entry key="/popular">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="popularPageController"/>
					</bean>
				</entry>
				<entry key="/admin">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="adminPageController"/>
						<property name="allowedFields">
							<list>
								<value>selTab</value>
								<value>interval</value>
								<value>limit</value>
								<value>aclUserInfo</value>
								<value>action</value>
							</list>
						</property>
					</bean>
				</entry>
					<entry key="/admin_userinfo">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="adminPageController"/>
						<property name="allowedFields">
							<list>
								<value>userinfo</value>
							</list>
						</property>
					</bean>
				</entry>
					<entry key="/admin_lucene">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="adminLuceneController"/>
						<property name="allowedFields">
							<list>
								<value>action</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/generalAjax">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="generalAjaxController"/>
						 <property name="allowedFields">
                            <list>
                                <value>action</value>
								<value>pageURL</value>
								<value>q</value>
								<value>requestedUser</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="adminAjaxController"/>
						 <property name="allowedFields">
                            <list>
                                <value>action</value>
								<value>userName</value>
								<value>value</value>
								<value>key</value>
								<value>evaluator</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/tags">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="popularTagsPageController"/>						
					</bean>
				</entry>	
<!--CK-->
				<entry key="/purpose">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="purposeTagsPageController"/>
					</bean>
				</entry>
				<entry key="/purposes">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="purposeUrlController"/>
					</bean>
				</entry>
<!--CK-->				
				<!-- actions  -->
				<entry key="/register">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="userRegistrationController"/>
						<property name="allowedFields">	
							<list>
								<value>registerUser.name</value>
								<value>registerUser.email</value>
								<value>registerUser.password</value>
								<value>registerUser.homepage</value>
								<value>registerUser.realname</value>
								<value>passwordCheck</value>
								<!-- for admins which want to register a new user -->
								<value>ckey</value>
								<!-- for recaptcha -->
								<value>recaptcha_response_field</value>
								<value>recaptcha_challenge_field</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/register_success">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="userRegistrationSuccessController"/>
					</bean>
				</entry>
				<entry key="/register_openid_success">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="userOpenIDRegistrationSuccessController"/>
					</bean>
				</entry>
				
				<!-- actions  -->
				<entry key="/registerOpenID">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="userOpenIDRegistrationController"/>
						<property name="allowedFields">	
							<list>		
								<!-- for admins which want to register a new user -->
								<value>ckey</value>
								<value>step</value>
								<value>registerUser.name</value>
								<value>registerUser.email</value>
								<value>registerUser.openID</value>
								<value>registerUser.password</value>
								<value>registerUser.homepage</value>
								<value>registerUser.realname</value>
								<value>registerUser.gender</value>
								<value>registerUser.place</value>																
							</list>
						</property>
					</bean>
				</entry>
				
				<entry key="/login">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="userLoginController"/>
						<property name="allowedFields">
							<list>
								<value>username</value>
								<value>password</value>
								<value>referer</value>
								<value>notice</value>
								<value>openID</value>							
							</list>
						</property>
					</bean>
				</entry>
				
				<entry key="/uploadFile">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="uploadFileController"/>
						<property name="allowedFields">
							<list>
								<value>file</value>
								<value>resourceHash</value>
							</list>
						</property>
					</bean>
				</entry>
				
				<entry key="/downloadFile">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="downloadFileController"/>
						<property name="allowedFields">
							<list>
								<value>intrahash</value>
								<value>requestedUser</value>
								<value>filename</value>
								<value>ckey</value>
								<value>action</value>
							</list>
						</property>
					</bean>
				</entry>
				
				<entry key="/reminder">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="passwordReminderController"/>
						<property name="allowedFields">
							<list>
								<value>userName</value>
								<value>userEmail</value>
								<value>recaptcha_response_field</value>
								<value>recaptcha_challenge_field</value>
							</list>
						</property>
					</bean>
				</entry>
				
				<entry key="/change_password">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="passwordChangeOnRemindController"/>
						<property name="allowedFields">
							<list>
								<value>userName</value>
								<value>newPassword</value>
								<value>passwordCheck</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/postBookmark">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="postBookmarkController"/>
						<property name="allowedFields" ref="bookmarkRequestParameters"/>
					</bean>
				</entry>
				<entry key="/postPublication">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="postPublicationController"/>
						<property name="allowedFields" ref="publicationRequestParameters"/>
					</bean>
				</entry> 
				<entry key="/actions/admin/group">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="groupAdminPageController"/>
					</bean>
				</entry>
				<entry key="/actions/goodBye">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="deleteUserController"/>
						<property name="allowedFields">
							<list>
								<value>delete</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/postBookmarkSuccess">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="postBookmarkSuccessController"/>
					</bean>
				</entry>
				<entry key="/mySearch">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="mySearchController"/>
					</bean>
				</entry>
				<entry key="/buttons">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="buttonPageController"/>
					</bean>
				</entry>
				<entry key="/allRelations">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="relationsController"/>
					</bean>
				</entry>
				<entry key="/post_bookmark">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="postBookmarkPageController"/>
					</bean>
				</entry>	
				<entry key="/followers">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="followersPageController"/>
					</bean>
				</entry>
				<entry key="/batchEdit_new">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="batchEditController"/>
						<property name="allowedFields">
							<list>
								<value>ckey</value>
								<value>oldTags[*]</value>
								<value>newTags[*]</value>
								<value>tags</value>
								<value>delete[*]</value>
								<value>referer</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/deletePost">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="deletePostController"/>
						<property name="allowedFields">
							<list>
								<value>resourceHash</value>
								<value>ckey</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/import">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="importController"/>
						<property name="allowedFields">
							<list>
								<value>file</value>
								<value>grouping</value>
								<value>importType</value>
								<value>overwrite</value>
								<value>userName</value>
								<value>passWord</value>
								<value>importData</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/jabrefImport">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="importJabRefLayout"/>
						<property name="allowedFields">
							<list>
								<value>fileBegin</value>
								<value>fileItem</value>
								<value>fileEnd</value>
								<value>action</value>
								<value>ckey</value>
								<value>hash</value>
							</list>
						</property>
					</bean>
				</entry>
			</map>
		</property>
	</bean>
	
	
    <!--  #################### request parameter lists #################### -->
	<!-- bookmark request parameters -->
	<util:list id="bookmarkRequestParameters">
		<value>post.resource.url</value>
		<value>post.resource.title</value>
		<value>post.description</value>
		<value>post.date</value> <!-- only allowed for DBLP and used by DBLP updater -->
		<value>tags</value>
		<value>url</value>
		<value>description</value>
		<value>extended</value>
		<value>copytag</value>
		<value>abstractGrouping</value>
		<value>groups</value>
		<value>intraHashToUpdate</value>
		<value>jump</value>
		<value>relevantGroups</value>
		<value>acceptComma</value>
		<value>postID</value>								
	</util:list>

	<!-- publication request parameters -->
	 <util:list id="publicationRequestParameters">
	  <value>post.description</value>
	  <value>post.date</value> <!-- only allowed for DBLP and used by DBLP updater -->
	  <value>post.resource.url</value>
	  <value>post.resource.title</value>
	  <value>post.resource.author</value>
	  <value>post.resource.editor</value>
	  <value>post.resource.entrytype</value>
	  <value>post.resource.bibtexKey</value>
	  <value>post.resource.year</value>
	  <value>post.resource.booktitle</value>
	  <value>post.resource.journal</value>
	  <value>post.resource.volume</value>
	  <value>post.resource.number</value>
	  <value>post.resource.series</value>
	  <value>post.resource.pages</value>
	  <value>post.resource.month</value>
	  <value>post.resource.day</value>
	  <value>post.resource.publisher</value>
	  <value>post.resource.edition</value>
	  <value>post.resource.chapter</value>
	  <value>post.resource.bKey</value>
	  <value>post.resource.type</value>
	  <value>post.resource.howpublished</value>
	  <value>post.resource.institution</value>
	  <value>post.resource.organization</value>
	  <value>post.resource.school</value>
	  <value>post.resource.crossref</value>
	  <value>post.resource.misc</value>
	  <value>post.resource.abstract</value>
	  <value>post.resource.privnote</value>
	  <value>post.resource.note</value>
	  <value>post.resource.annote</value>
  	  <value>post.resource.address</value>
      <value>post.resource.key</value>	  
	  <value>tags</value>
	  <value>url</value>
	  <value>description</value>
	  <value>extended</value>
	  <value>copytag</value>
	  <value>abstractGrouping</value>
	  <value>groups</value>
	  <value>intraHashToUpdate</value>
	  <value>jump</value>
	  <value>relevantGroups</value>
	  <value>acceptComma</value>
	  <value>postID</value>        
	 </util:list>

    <!--  #################### controller #################### -->
	<bean id="homepageController" class="org.bibsonomy.webapp.controller.HomepageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
	</bean>
	
	<bean id="relationsController" class="org.bibsonomy.webapp.controller.RelationsController" scope="request">
		<property name="logic" ref="logic"/>
	</bean>
	
	<bean id="followersPageController" class="org.bibsonomy.webapp.controller.FollowersPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>		
	</bean>
	
	<bean id="settingsPageController" class="org.bibsonomy.webapp.controller.SettingsPageController" scope="request">
		<property name="logic" ref="logic"/>
		<!-- <property name="userSettings" ref="userSettings"/> -->
		<!-- <property name="docpath"><value>${project.document.path}</value></property> -->
	</bean>

	<bean id="userPageController" class="org.bibsonomy.webapp.controller.UserPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
	</bean>
	
	<bean id="mySearchController" class="org.bibsonomy.webapp.controller.MySearchController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
	</bean>
	
	<bean id="friendsPageController" class="org.bibsonomy.webapp.controller.FriendsPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
	</bean>
	
	<bean id="friendPageController" class="org.bibsonomy.webapp.controller.FriendPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
	</bean>
	
	<bean id="groupPageController" class="org.bibsonomy.webapp.controller.GroupPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
	</bean>
	
	<bean id="groupsPageController" class="org.bibsonomy.webapp.controller.GroupsPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
	</bean>	
	
	<bean id="viewablePageController" class="org.bibsonomy.webapp.controller.ViewablePageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
	</bean>
	
	<bean id="tagPageController" class="org.bibsonomy.webapp.controller.TagPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
	</bean>
	
	<bean id="authorPageController" class="org.bibsonomy.webapp.controller.AuthorPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
			</list>
		</property>
	</bean>

	<bean id="authorsPageController" class="org.bibsonomy.webapp.controller.AuthorsPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
	</bean>
	
	<bean id="userRelationsController" class="org.bibsonomy.webapp.controller.UserRelationsController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
	</bean>
	
	<bean id="exportPageController" class="org.bibsonomy.webapp.controller.ExportPageController" scope="request">
		<property name="layoutRenderer" ref="jabrefLayoutRenderer"/>
		<property name="requestLogic" ref="requestLogic"/>
	</bean>

	<bean id="conceptPageController" class="org.bibsonomy.webapp.controller.ConceptPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
	</bean>
	
	<bean id="bibtexPageController" class="org.bibsonomy.webapp.controller.BibtexPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
			</list>
		</property>
	</bean>

	<bean id="basketPageController" class="org.bibsonomy.webapp.controller.BasketPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
			</list>
		</property>
	</bean>	 	
	
	<!-- 
		Implements the UnAPI specification http://unapi.info/
		* returns an overview of the supported formats
		* given an ID and a format, returns the post in the chosen format
		* basically redirects to existing controllers
	-->
	<bean id="UnAPIController" class="org.bibsonomy.webapp.controller.special.UnAPIController" scope="request">
		<property name="responseLogic" ref="responseLogic"/>
	</bean>
	 
	<!-- 
	   Does various redirects, like /myRelations, /myBibSonomy, etc.
	 -->
	<bean id="RedirectController" class="org.bibsonomy.webapp.controller.special.RedirectController" scope="request">
		<property name="requestLogic" ref="requestLogic"/>
	</bean>

	<bean id="buttonPageController" class="org.bibsonomy.webapp.controller.special.StaticViewController" scope="request">
		<property name="view" value="BUTTONS"></property>
	</bean>

	<bean id="postBookmarkPageController" class="org.bibsonomy.webapp.controller.special.StaticViewController" scope="request">
		<property name="view" value="POST_BOOKMARK_PAGE"></property>
	</bean>

	<bean id="batchEditController" class="org.bibsonomy.webapp.controller.actions.BatchEditController" scope="request">
		<property name="logic" ref="logic"/>
	</bean>

	<bean id="bibtexkeyPageController" class="org.bibsonomy.webapp.controller.BibtexkeyPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
			</list>
		</property>
	</bean>
	 
	<bean id="urlPageController" class="org.bibsonomy.webapp.controller.UrlPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
	</bean>
	
	<bean id="searchPageController" class="org.bibsonomy.webapp.controller.SearchPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
	</bean>
	
	<bean id="adminPageController" class="org.bibsonomy.webapp.controller.AdminPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
	</bean>
	
	<bean id="adminLuceneController" class="org.bibsonomy.webapp.controller.AdminLuceneController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
	</bean>

	<bean id="adminAjaxController" class="org.bibsonomy.webapp.controller.AdminAjaxController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
	</bean>
		
	<bean id="generalAjaxController" class="org.bibsonomy.webapp.controller.GeneralAjaxController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
	</bean>	
	
	<bean id="popularTagsPageController" class="org.bibsonomy.webapp.controller.PopularTagsPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
	</bean>
	
	<bean id="popularPageController" class="org.bibsonomy.webapp.controller.PopularPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
		<property name="listsToInitialise">
			<list>
				<value type="java.lang.Class">org.bibsonomy.model.BibTex</value>
				<value type="java.lang.Class">org.bibsonomy.model.Bookmark</value>
			</list>
		</property>
		<property name="entriesPerPage">
			<value type="java.lang.Integer">3</value>
		</property>
	</bean>
			
	<!--<bean id="buttonPageController" class="org.bibsonomy.webapp.controller.ButtonPageController"/>-->	

	<!-- <bean id="purposeTagsPageController" class="org.bibsonomy.webapp.controller.PurposeTagsPageController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
	</bean>

	<bean id="purposeUrlController" class="org.bibsonomy.webapp.controller.PurposeUrlController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
	</bean>-->
	<!-- 
	    This bean provides admin access to the logic interface by predicting 
	    to be a user with role "admin". 
	 -->
	<bean id="adminLogic" class="org.bibsonomy.webapp.util.spring.factorybeans.AdminLogicFactoryBean" scope="request">
	    <!-- name the admin user will have when accessing the logic interface -->
		<property name="adminUserName" value="admin"/>
		<property name="dbSessionFactory" ref="dbSessionFactory"/>
	</bean>	
	
	<bean id="dbSessionFactory" class="org.bibsonomy.database.util.IbatisDBSessionFactory"/>
	
	<!--  #################### factory beans #################### -->
	
	<bean id="jabrefLayoutRenderer" class="org.bibsonomy.layout.jabref.JabrefLayoutRenderer" factory-method="getInstance"/>

	<!-- provides access to the request for all controllers, which need it -->
	<bean id="requestLogic" class="org.bibsonomy.webapp.util.RequestLogic" scope="request"/>

	<!-- provides access to the response for all controllers, which need it -->
	<bean id="responseLogic" class="org.bibsonomy.webapp.util.ResponseLogic" scope="request"/>

	<!-- provides access to cookies -->
	<bean id="cookieLogic" class="org.bibsonomy.webapp.util.CookieLogic" scope="request">
		<property name="requestLogic" ref="requestLogic"/>
		<property name="responseLogic" ref="responseLogic"/>
		<!-- configuration of cookies -->
		<property name="cookieAge" value="31536000"/><!-- one year (= 3600 * 24 * 365 seconds) -->
		<property name="cookiePath" value="/"/>
		<property name="cookieUser" value="_currUser"/>
		<property name="cookieSpammer" value="_lPost"/>
	</bean>

	<!-- an instance of the currently logged in user -->
	<bean id="loginUser" class="org.bibsonomy.webapp.util.spring.factorybeans.UserFactoryBean" scope="request">
		<property name="requestLogic" ref="requestLogic"/>
	</bean>	
	
	<!-- the settings of the currently logged in user -->
	<bean id="userSettings" class="org.bibsonomy.webapp.util.spring.factorybeans.UserSettingsFactoryBean" scope="request">
		<property name="user" ref="loginUser"/>
	</bean>

	<!-- provides access to the database for all controllers -->
	<bean id="logic" class="org.bibsonomy.webapp.util.spring.factorybeans.LogicFactoryBean" scope="request">
		<property name="user" ref="loginUser"/>
		<property name="dbSessionFactory" ref="dbSessionFactory"/>
	</bean>		
	
	<bean id="deliciousImporterFactory" class="org.bibsonomy.importer.bookmark.service.DeliciousImporterFactory">
		<property name="bundlesPath" value="/v1/tags/bundles/all"/>
		<property name="postsPath" value="/v1/posts/all"/>
		<property name="port" value="-1"/>
		<property name="protocol" value="https"/>
		<property name="host" value="api.del.icio.us"/>
		<property name="userAgent" value="Wget/1.9.1"/>
	</bean>
	
	<!--  #################### interceptors #################### -->

	<bean id="localeChangeInterceptor" class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
		<property name="paramName" value="lang" />
	</bean>	
	
	<bean id="requestWrapperContextInterceptor" class="org.bibsonomy.webapp.util.spring.RequestWrapperContextHandlerInterceptor">
	</bean>
	
	
	<!--  #################### locale stuff #################### -->
	
	<bean id="localeResolver" class="org.springframework.web.servlet.i18n.SessionLocaleResolver"/>
	
  

	<!--  #################### view resolver #################### -->
	<!-- default: JSPs -->
	<bean id="viewResolver"	class="org.springframework.web.servlet.view.InternalResourceViewResolver">
		<property name="viewClass" value="org.springframework.web.servlet.view.JstlView" />
		<property name="prefix" value="/WEB-INF/jsp/" />
		<property name="suffix" value=".jspx" />
	</bean>
	
	<!-- used to resolve non-JSP views, e.g., JabRef's layout views -->
	<bean id="nonJSPViewResolver" class="org.springframework.web.servlet.view.XmlViewResolver">
    	<property name="order" value="1"/>
	</bean>
	
	<bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver"/>
	

	<!--  #################### imports #################### -->

    <import resource="bibsonomy2-servlet-recommender.xml"/>	
    <import resource="bibsonomy2-servlet-actions.xml"/>
    <import resource="bibsonomy2-servlet-ajax.xml"/>	
    <import resource="bibsonomy2-servlet-fields.xml"/> 
</beans>
