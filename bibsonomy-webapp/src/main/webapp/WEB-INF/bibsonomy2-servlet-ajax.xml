<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:util="http://www.springframework.org/schema/util"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
	                    http://www.springframework.org/schema/beans/spring-beans.xsd
	                    http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.5.xsd">


	<!--+
		| url mapping for ajax request: /ajax/*
		+-->
	<bean id="ajaxUrlMapping" parent="urlMapping"
		class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
		<property name="urlMap">
			<map merge="true">
				<entry key="/generalAjax">
					<bean parent="controllerBase">
						<property name="controllerBeanName" value="generalAjaxController"/>
						 <property name="allowedFields">
                            <list>
                                <value>action</value>
								<value>pageURL</value>
								<value>q</value>
								<value>requestedUser</value>
							</list>
						</property>
					</bean>
				</entry>
				<!-- get recommendations for user -->
				<entry key="/ajax/getBookmarkRecommendedTags">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="ajaxGetBookmarkRecommendedTagsController" />
						<property name="allowedFields" ref="bookmarkRequestParameters" />
					</bean>
				</entry>
				<entry key="/ajax/getPublicationRecommendedTags">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="ajaxGetPublicationRecommendedTagsController" />
						<property name="allowedFields">
							<list>
								<value>postID</value>
								
								<!-- to support old edit_bibtex.jsp (with short paths) ... -->
								<value>crossref</value>
								<value>type</value>
								<value>title</value>
								<value>url</value>
								<value>description</value>
								<value>author</value>
								<value>editor</value>
								<value>journal</value>
								<value>volume</value>
								<value>chapter</value>
								<value>edition</value>
								<value>year</value>
								<value>misc</value>
								<value>month</value>
								<value>day</value>
								<value>booktitle</value>
								<value>howpublished</value>
								<value>institution</value>
								<value>organization</value>
								<value>publisher</value>
								<value>address</value>
								<value>school</value>
								<value>series</value>
								<value>bibtexKey</value>
								<value>group</value>
								<value>user</value>
								<value>annote</value>
								<value>key</value>
								<value>note</value>
								<value>number</value>
								<value>pages</value>
								<value>bibtexAbstract</value>
								<value>entrytype</value>
								<value>privnote</value>
								<value>relevantFor</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/handleFollower">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="followerAjaxController" />
						<property name="allowedFields" >
							<list>
								<value>requestedUserName</value>
								<value>action</value>
								<value>forward</value>
								<value>ckey</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="/ajax/pickUnpickPost">
					<bean parent="controllerBase">
						<property name="controllerBeanName"	value="basketController" />
						<property name="allowedFields" >
							<list>
								<value>requestedResourceHash</value>
								<value>action</value>
								<value>user</value>
								<value>ckey</value>
							</list>
						</property>
					</bean>
				</entry>
			</map>
		</property>
	</bean>


	<!--+
		| ajax controller
		+-->

	<bean id="generalAjaxController" class="org.bibsonomy.webapp.controller.GeneralAjaxController" scope="request">
		<property name="logic" ref="logic"/>
		<property name="userSettings" ref="userSettings"/>
	</bean>	
		
		
	<!-- controller for handling recommendation requests -->
	<bean id="ajaxGetBookmarkRecommendedTagsController"
		class="org.bibsonomy.webapp.controller.ajax.GetBookmarkRecommendedTagsController"
		scope="request">
		<property name="logic" ref="logic" />
		<!-- used for accessing spam informations -->
		<property name="adminLogic" ref="adminLogic"/>  
		<property name="userSettings" ref="userSettings" />
		<property name="tagRecommender"	ref="multiplexingTagRecommender" />
		<!-- tag recommender used for spammer -->
		<property name="spamTagRecommender" ref="jensRecommender"/>
	</bean>
	
	<bean id="ajaxGetPublicationRecommendedTagsController"
		class="org.bibsonomy.webapp.controller.ajax.GetPublicationRecommendedTagsController"
		scope="request">
		<property name="logic" ref="logic" />
		<!-- used for accessing spam informations -->
		<property name="adminLogic" ref="adminLogic"/>
		<property name="userSettings" ref="userSettings" />
		<property name="tagRecommender" ref="multiplexingTagRecommender" />
		<!-- tag recommender used for spammer -->
		<property name="spamTagRecommender" ref="jensRecommender"/>
	</bean>
	
	
	<bean id="followerAjaxController" class="org.bibsonomy.webapp.controller.ajax.FollowerAjaxController" scope="request">
		<property name="logic" ref="logic" />
	</bean>
	
	
	<bean id="basketController" class="org.bibsonomy.webapp.controller.ajax.BasketController" scope="request">
		<property name="logic" ref="logic" />
		<property name="requestLogic" ref="requestLogic"/>
	</bean>

</beans>
