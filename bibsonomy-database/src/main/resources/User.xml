<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="User">

	<select id="getAllUsers" resultMap="Common.user" parameterClass="userParam">
		SELECT user_name FROM user WHERE spammer = 0 LIMIT #limit# OFFSET #offset#
	</select>

	<select id="getApiKeyForUser" resultClass="string" parameterClass="string">
		SELECT api_key FROM user where user_name = #userName#
	</select>

	<update id="updateApiKeyForUser" parameterClass="user">
		UPDATE user SET api_key = #apiKey# WHERE user_name = #name#
	</update>

	<select id="getUserDetails" resultMap="UserCommon.user" parameterClass="string">
		SELECT user_name, user_email, user_homepage, user_realname, openUrl, api_key
		FROM user WHERE user_name = #username#
	</select>

	<select id="getUserNamesByGroupId" resultClass="string" parameterClass="int">
		SELECT user_name FROM groups WHERE `group` = $groupId$
	</select>

	<insert id="insertUser" parameterClass="user">
		INSERT INTO user (user_name, user_email, user_password, user_realname, user_homepage, api_key)
		VALUES (#name#, #email#, #password#, #realname#, #homepage#, #apiKey#)
	</insert>

</sqlMap>