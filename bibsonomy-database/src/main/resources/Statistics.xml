<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Statistics">

	<select id="getNumberOfRelationsForUser" resultClass="int" parameterClass="String">
		SELECT count(*) FROM 
            (SELECT count(upper) AS tag_name, GROUP_CONCAT(lower ORDER BY lower SEPARATOR '') AS subtags
                FROM tagtagrelations
                WHERE user_name=#userName#
                GROUP BY upper
                ORDER BY upper
            ) as b
	</select>

</sqlMap>