<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="GroupCommon">

	<resultMap id="group_basic"	class="group">
		<result property="groupId"         	 	column="group"             javaType="int" />
		<result property="name"             	column="group_name"        javaType="string" />
		<result property="privlevel"        	column="privlevel"         javaType="Privlevel"/>
		<result property="sharedDocuments"  	column="sharedDocuments"   javaType="boolean"/>
	</resultMap>

	<resultMap id="publReportingSettings" class="publicationReportingSettings">
		<result property="reportingMailAddress" column="publ_reporting_mail" javaType="string" />
		<result property="reportingMailTemplate" column="publ_reporting_mail_template" javaType="string"/>
		<result property="externalReportingUrl" column="publ_reporting_external_url" javaType="string" />
	</resultMap>
	
	<resultMap id="groupRequest" class="groupRequest">
		<result property="userName" column="request_user_name" javaType="string" />
		<result property="reason" column="request_reason" javaType="string"/>
		<result property="submissionDate" column="request_submission_date" javaType="date" />
	</resultMap>
	
	<resultMap id="group" class="group" extends="group_basic" groupBy="name">
		<result property="publicationReportingSettings" resultMap="GroupCommon.publReportingSettings" />
		<result property="groupRequest" resultMap="GroupCommon.groupRequest" />
	</resultMap>
	
	<resultMap id="groupMembership" class="groupMembership">
		<result property="userSharedDocuments" 	column="user_shared_documents" javaType="boolean" />
		<result property="groupRole" 	column="group_role" javaType="GroupRole" />
		<result property="user"    resultMap="UserCommon.userForGroup" />
	</resultMap>
	
	<resultMap id="groupWithMemberships" class="group" extends="group_basic" groupBy="name" >
		<result property="memberships" resultMap="GroupCommon.groupMembership" />
	</resultMap>
	
	<resultMap id="groupWithMembershipsAndReportings" class="group" extends="groupWithMemberships" groupBy="name" >
		<result property="publicationReportingSettings" resultMap="GroupCommon.publReportingSettings" />
	</resultMap>
	
	<resultMap id="tagsets" class="tagset" groupBy="setName">
		<result property="setName"   	column="set_name"  	javaType="string"  />
		<result property="tags"         resultMap="Common.tag" />
	</resultMap>
	
	<sql id="requestColumns">
		i.request_user_name, i.request_reason, i.request_submission_date
	</sql>
	
	<sql id="reportingColumns">
		i.publ_reporting_mail, i.publ_reporting_mail_template, i.publ_reporting_external_url
	</sql>
</sqlMap>