<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="PersonCommon">
	<resultMap id="person" class="org.bibsonomy.model.Person">
		<result property="id"          		column="person_id"          javaType="String" />
		<result property="names" 			column="person_id"	 		javaType='java.util.ArrayList' select='getNames' />
		<result property="orcid"       		column="orcid"        		javaType="java.lang.String" />
		<result property='academicDegree' 	column='academic_degree'	javaType='java.lang.String' />
		<result property="postCounter" 		column="post_ctr"     		javaType="integer" />
		<result property="changedBy"   		column="log_modified_by"   	javaType="java.lang.String" />
		<result property="changeDate"  		column="log_modified_at"  	javaType="java.util.Date" />
		<result property="user"        		column="user_name"    		javaType="java.lang.String" />
		<result property='disambiguatingPublication'	column='person_id' javaType='org.bibsonomy.model.ResourcePersonRelation' select='getOneResourcePersonRelationsByPersonId'/>
		<result property='resourcePersonRelations'		column='person_id' javaType='org.bibsonomy.model.ResourcePersonRelation' select='getResourcePersonRelationsByPersonId'/>
	</resultMap>
	
	<resultMap id="personName" class="org.bibsonomy.model.PersonName">
		<result property="id" 			column="id" 		javaType="integer" />
		<result property="firstName" 	column="first_name"	javaType="java.lang.String" />
		<result property="lastName" 	column="last_name" 	javaType="java.lang.String" />
		<result property="personId" 	column="person_id" 	javaType="java.lang.String" />
		<result property='isMain'		column='is_main'	javaType='boolean' />
		<result property="person"		column="person_id"  javaType='org.bibsonomy.model.Person' select='getPersonById' />
	</resultMap>
	
	<resultMap id='resourcePersonRelation' class='org.bibsonomy.model.ResourcePersonRelation'>
		<result property='id'           column='id'           javaType='int' />
		<result property='qualifying'   column='qualifying'   javaType='int' />
		<result property='personId'     column='person_id'    javaType='java.lang.String' />
		<result property='relationType' column='relator_code' javaType='org.bibsonomy.model.enums.PersonResourceRelationType' />
		<result property='pubOwner'     column='pub_owner'    javaType='java.lang.String' />
		<result property="person"       column="person_id"    javaType='org.bibsonomy.model.Person'       select='getPersonById' />
		<result property='post'         column='simhash1'     javaType='bibtex'                           select='getPosts'/>
		<result property='personIndex'  column='author_index' javaType='int' />
	</resultMap>
	
	<sql id="commonPersonColumns">
		person.person_id, person.academic_degree, person.orcid, person.post_ctr, person.log_modified_by, person.log_modified_at, person.user_name
	</sql>
	
	<sql id='commonPersonNameColumns'>
		person_name.id, person_name.first_name, person_name.last_name, person_name.person_id, person_name.is_main
	</sql>
	
	<sql id="insertPersonAttributes">
		#id#, #orcid#, #academicDegree#, #postCounter#, #changedBy#, #changeDate#, #user#
	</sql>
	
	<sql id="commonResourcePersonRelationAttributes">
		#id#, #post.resource.interHash#, #post.resource.intraHash#, #qualifying#, #personId#, #relationType.relatorCode# , #post.user.name#, #personIndex#
	</sql>
	
	<sql id="commonResourcePersonRelationColumns">
		pub_person.id, pub_person.simhash1, pub_person.simhash2, pub_person.qualifying, pub_person.person_id, pub_person.relator_code, pub_person.pub_owner, pub_person.author_index
	</sql>
	
</sqlMap>