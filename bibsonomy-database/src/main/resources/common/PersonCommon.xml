<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="PersonCommon">
	<resultMap id="person" class="org.bibsonomy.model.Person">
		<result property="id"          		column="person_id"          javaType="integer" />
		<result property="names" 			column="person_id"	 		javaType='java.util.ArrayList' select='getNames' />
		<result property="orcid"       		column="orcid"        		javaType="java.lang.String" />
		<result property='academicDegree' 	column='academic_degree'	javaType='java.lang.String' />
		<result property="postCounter" 		column="post_ctr"     		javaType="integer" />
		<result property="changedBy"   		column="log_modified_by"   	javaType="java.lang.String" />
		<result property="changeDate"  		column="log_modified_at"  	javaType="java.util.Date" />
		<result property="user"        		column="user_name"    		javaType="java.lang.String" />
	</resultMap>
	
	<resultMap id="personName" class="org.bibsonomy.model.PersonName">
		<result property="id" 			column="id" 		javaType="integer" />
		<result property="firstName" 	column="first_name"	javaType="java.lang.String" />
		<result property="lastName" 	column="last_name" 	javaType="java.lang.String" />
		<result property="personId" 	column="person_id" 	javaType="integer" />
		<result property='isMain'		column='is_main'	javaType='boolean' />
		<result property="person"		column="person_id"  javaType='org.bibsonomy.model.Person' select='getPersonById' />
	</resultMap>
	
	<resultMap id='resourcePersonRelation' class='org.bibsonomy.model.ResourcePersonRelation'>
		<result property='id' 			column='id' javaType='int' />
		<result property='simhash1' 	column='simhash1' javaType='java.lang.String' />
		<result property='simhash2' 	column='simhash2' javaType='java.lang.String' />
		<result property='qualifying' 	column='qualifying' javaType='int' />
		<result property='personNameId' column='person_name_id' javaType='int' />
		<result property='relatorCode' 	column='relator_code' javaType='java.lang.String' />
		<result property='pubOwner'		column='pub_owner'	javaType='java.lang.String' />
		<result property='personName'	column='person_name_id' javaType='org.bibsonomy.model.PersonName' select='getPersonNameById' />
		<result property='post'			column='{pubOwner=pub_owner, simhash1=simhash1, simhash2=simhash1}' javaType='bibtex' select='getPosts'/>
	</resultMap>
	
	<sql id="commonPersonColumns">
		person.person_id, person.academic_degree, person.orcid, person.post_ctr, person.log_modified_by, person.log_modified_at, person.user_name
	</sql>
	
	<sql id='commonPersonNameColumns'>
		person_name.id, person_name.first_name, person_name.last_name, person_name.person_id, person_name.is_main
	</sql>
	
	<sql id="insertPersonAttributes">
		#id#, #orcid#, #academicDegree#, #postCounter#, #changedBy#, #changeDate#, #user#
	</sql>
	
	<sql id="commonResourcePersonRelationAttributes">
		#id#, #simhash1#, #simhash2#, #qualifying#, #personNameId#, #relatorCode# , #pubOwner#
	</sql>
	
	<sql id="commonResourcePersonRelationColumns">
		pub_person.id, pub_person.simhash1, pub_person.simhash2, pub_person.qualifying, pub_person.person_name_id, pub_person.relator_code, pub_person.pub_owner
	</sql>
	
</sqlMap>