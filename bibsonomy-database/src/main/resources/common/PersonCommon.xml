<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="PersonCommon">
	<resultMap id="abstractPerson" class="org.bibsonomy.model.Person" groupBy="personId">
		<result property="personChangeId"   column="p_person_change_id"    javaType="int" />
		<result property="personId"         column="person_id"           javaType="String" />
		
		<result property="orcid"            column="orcid"               javaType="java.lang.String" />
		<result property='academicDegree'   column='academic_degree'     javaType='java.lang.String' />
		<result property="dnbPersonId"      column="dnb_person_id"       javaType="java.lang.String" />
		<result property='gender'           column='gender'              javaType='org.bibsonomy.model.enums.Gender' />
		<result property="postCounter"      column="post_ctr"            javaType="integer" />
		<result property="changedBy"        column="log_changed_by"      javaType="java.lang.String" />
		<result property="changeDate"       column="log_changed_at"      javaType="java.util.Date" />
		<result property="user"             column="user_name"           javaType="java.lang.String" />
		
		<result property="college"          column="college"           	 javaType="java.lang.String" />
		<result property="homepage"         column="homepage"     		 javaType="java.lang.String" />
		<result property="email"            column="email"           	 javaType="java.lang.String" />
		
	</resultMap>
	
	<resultMap id='lazyLoadingPerson' class='org.bibsonomy.model.Person' extends="abstractPerson">
		<result property="names"            column="person_id"           javaType='java.util.ArrayList' select='getNames' />
	</resultMap>
	
	<resultMap id='personWithNamesPrefilled' class='org.bibsonomy.model.Person' extends="abstractPerson">
		<result property="names"            resultMap="PersonCommon.personName" />
	</resultMap>
	
	
	<resultMap id="personName" class="org.bibsonomy.model.PersonName" groupBy="personNameChangeId">
		<result property="personNameChangeId"  column="n_person_change_id"  javaType="int" />
		<result property="firstName"       column="first_name"        javaType="java.lang.String" />
		<result property="lastName"        column="last_name"         javaType="java.lang.String" />
		<result property="personId"        column="person_id"         javaType="java.lang.String" />
		<result property='isMain'          column='is_main'           javaType='boolean' />
		<result property='changedBy'       column='log_changed_by'    javaType='java.lang.String' />
		<result property="changedAt"       column="log_changed_at"    javaType="java.util.Date" />
	</resultMap>
	
	<resultMap id='abstractResourcePersonRelation' class='org.bibsonomy.model.ResourcePersonRelation'>
		<result property='personRelChangeId' column='r_person_change_id' javaType='int' />
		<result property='qualifying'        column='qualifying'       javaType='int' />
		<result property='relationType'      column='relator_code'     javaType='personResourceRelationType' />
		<result property='changedBy'         column='log_changed_by'   javaType='java.lang.String' />
		<result property="changedAt"         column="log_changed_at"   javaType="java.util.Date" />
		<result property='personIndex'       column='person_index'     javaType='int' />
	</resultMap>
	
	<resultMap id='lazyLoadingResourcePersonRelation' class='org.bibsonomy.model.ResourcePersonRelation' groupBy="personRelChangeId" extends="abstractResourcePersonRelation">
		<result property="person"          column="person_id"       javaType='org.bibsonomy.model.Person'       select='getPersonById' />
		<result property='post'            column='simhash1'        javaType='bibtex'                           select='getPosts'/>
	</resultMap>
	
	<resultMap id='resourcePersonRelationWithPersonPrefilled' class='org.bibsonomy.model.ResourcePersonRelation' groupBy="personRelChangeId" extends="abstractResourcePersonRelation">
		<result property="person"          resultMap="PersonCommon.personWithNamesPrefilled" />
	</resultMap>
	
	<resultMap id='resourcePersonRelationLogStub' class='org.bibsonomy.model.ResourcePersonRelationLogStub' groupBy="personRelChangeId" extends="abstractResourcePersonRelation">
		<result property="personId"        column="person_id"       javaType='java.lang.String' />
		<result property='postInterhash'   column='simhash1'        javaType='java.lang.String' />
		<result property='deleted'         column='deleted'         javaType='boolean' />
	</resultMap>
	
	<resultMap id='preFilledResourcePersonRelation' class='org.bibsonomy.model.ResourcePersonRelation' groupBy="personRelChangeId" extends="abstractResourcePersonRelation">
		<result property="person"          column="person_id"       javaType='org.bibsonomy.model.Person'       select='getPersonById' />
		<result property='post'            resultMap="BibTexCommon.bibtexPost" />
	</resultMap>
	
	<resultMap id='preFilledCommunityResourcePersonRelation' class='org.bibsonomy.model.ResourcePersonRelation' groupBy="personRelChangeId" extends="abstractResourcePersonRelation">
		<result property="person"          column="person_id"       javaType='org.bibsonomy.model.Person'       select='getPersonById' />
		<result property='post'            resultMap="GoldStandardPublicationCommon.goldStandardPost" />
	</resultMap>
	
	<resultMap id='similarPersonMatch' class='org.bibsonomy.model.Match'>
		<result property='matchID' column='match_id'/>
		<result property='sim' column='sim'/>
		<result property='denied' column='denied'/>
		<result property='mode' column='mode'/>
		<result property='person1ID' column='person1_id'/>
		<result property='person2ID' column='person2_id'/>
		<result property='item1ID' column='item1_id'/>
		<result property='item2ID' column='item2_id'/>
	</resultMap>
	
	<sql id="commonPersonColumns">
		person.person_change_id as p_person_change_id, person.person_id, person.academic_degree, person.orcid, person.post_ctr, person.log_changed_by, person.log_changed_at, person.user_name, person.dnb_person_id, gender, person.college, person.email, person.homepage
	</sql>
	
	<sql id="commonPersonColumnsPlain">
		person.person_change_id, person.person_id, person.academic_degree, person.orcid, person.post_ctr, person.log_changed_by, person.log_changed_at, person.user_name, person.dnb_person_id, gender, person.college, person.email, person.homepage
	</sql>
	
	<sql id='commonPersonNameColumns'>
		person_name.person_change_id as n_person_change_id, person_name.first_name, person_name.last_name, person_name.person_id, person_name.is_main, person_name.log_changed_by, person_name.log_changed_at
	</sql>
	
	<sql id='commonPersonNameColumnsPlain'>
		person_name.person_change_id as n_person_change_id, person_name.first_name, person_name.last_name, person_name.person_id, person_name.is_main, person_name.log_changed_by, person_name.log_changed_at
	</sql>
	
	<sql id="insertPersonAttributes">
		#personChangeId#, #personId#, #academicDegree#, #orcid#, #postCounter#, #changedBy#, #changeDate#, #user#, #dnbPersonId#, #gender#, #college#, #email#, #homepage#
	</sql>
	
	<sql id="commonResourcePersonRelationAttributes">
		#personRelChangeId#, #post.resource.interHash#, #post.resource.intraHash#, #qualifying#, #person.personId#, #relationType.relatorCode# , #changedBy#, #changedAt#, #personIndex#
	</sql>
	
	<sql id="commonResourcePersonRelationColumns">
		pub_person.person_change_id as r_person_change_id, pub_person.simhash1, pub_person.simhash2, pub_person.qualifying, pub_person.person_id, pub_person.relator_code, pub_person.log_changed_by, pub_person.log_changed_at, pub_person.person_index
	</sql>
	
	<sql id="commonResourcePersonRelationColumnsPlain">
		pub_person.person_change_id, pub_person.simhash1, pub_person.simhash2, pub_person.qualifying, pub_person.person_id, pub_person.relator_code, pub_person.log_changed_by, pub_person.log_changed_at, pub_person.person_index
	</sql>
	
	<sql id="commonResourcePersonRelationColumns2">
		b2.person_change_id as r_person_change_id, b2.simhash1, b2.simhash2, b2.qualifying, b2.person_id, b2.relator_code, b2.log_changed_by, b2.log_changed_at, b2.person_index
	</sql>

</sqlMap>