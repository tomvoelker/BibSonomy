<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="SearchPublicationCommon">

	<resultMap id="searchPublicationPost" class="searchPost" extends="BibTexCommon.bibtexPostWithDocuments">
		<result property="lastTasId"    column="tas_id" />
	</resultMap>

	<resultMap id="searchLogPublicationPost" class="searchPost" extends="BibTexCommon.bibtexPostWithDocuments">
		<result property="lastTasId"    column="tas_id" />
		<result property="lastLogDate"  column="log_date" javaType="date"/>
	</resultMap>
	
	<resultMap id="searchLogDocumentPublicationPost" class="searchPost" groupBy="contentId">
		<result property="contentId"    column="content_id"     javaType="int" />
		<result property="resource"     resultMap="SearchPublicationCommon.bibtexWithDocuments" />
	</resultMap>
	
	<resultMap id="bibtexWithDocuments" class="bibtex">
		<!-- FIXME: title must be set, else the resource is null -->
		<result property="title"        column="title"    javaType="string" />
		<result property="documents"      resultMap="DocumentCommon.document" />
	</resultMap>
	
	<sql id="commonSearchPublicationAttributes2">
		<include refid="commonPublicationAttributes2WithoutPrivNote" />
		b2.privnote
	</sql>
	
	<sql id="searchPublicationAttributes2">
		<include refid="bibtexAttributes2"/>,
		t.tas_id
	</sql>

</sqlMap>