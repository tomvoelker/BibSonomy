<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE document PUBLIC
  "-//Apache Software Foundation//DTD XDOC 1.0//EN"
  "http://maven.apache.org/dtd/xdoc_1_0.dtd">
<document>
	<properties>
		<title>Inside BibSonomy</title>
	</properties>
	<body>
		<section name="Inside BibSonomy">
		
	      <subsection name="Hashes of Publication Posts">
	      	      
	        <h4>Motivation</h4> 
	      
			<p>
				In particular for literature references there is the
				problem of detecting duplicate posts, because there are
				big variations in how users enter fields such as journal
				name or author. On the one hand it is desirable to allow
				a user to have several posts which differ only slightly.
				On the other hand one might want to find other users
				posts which refer to the same paper or book even if they
				are not completely identical.
			</p>

			<p>
				To fulfill both goals we implemented two hashes to
				compare publication posts. One is for comparing the
				posts of a single user (<em>intra</em> user hash) 
				and one for comparing the posts of different
				users (<em>inter</em>user hash). Comparison is 
				accomplished by normalizing
				and concatenating BibTeX fields, hashing the result with
				the <a href="ftp://ftp.rfc-editor.org/in-notes/rfc1321.txt">MD5 message digest</a>
				algorithm and comparing the resulting hashes. MD5
				hashing is done for efficiency reasons only, since this
				allows for a fixed length storage in the database.
				Storing the hashes along with the resources in the posts
				table enables fast comparison and search of posts.
			</p>

			<p>
				The
				<em>intra user hash</em>
				is relatively strict and takes into account the fields
				<em>title</em>,	<em>author</em>, <em>editor</em>,
				<em>year</em>, <em>entrytype</em>, <em>journal</em>,
				<em>booktitle</em>, <em>volume</em>, and <em>number</em>. 
				This allows one to have articles with the same title
				from the same authors in the same year but in different
				volumes (e.g., a technical report and the corresponding
				journal article).
			</p>

			<p>
				In contrast, the
				<em>inter user hash</em>
				is less specific and includes only the
				<em>title</em>, <em>year</em> and <em>author</em> or <em>editor</em>
				(depending on what the user has entered).
			</p>

			<p>
				In both hashes all fields which are taken into account
				are normalized, i.e., certain special characters are
				removed, whitespace and author/editor names normalized.
				The latter is done by concatenating the first letter of
				the first name by a dot with the last name, both in
				lower case. Persons are then sorted alphabetically by
				this string and concatenated by a colon.
			</p>
			
			
			
			<h4>Demo</h4>
			
			<p>
			To demonstrate the generation of the inter- and intra-user hash, 
			you can fill out and submit the following form. BibSonomy then will 
			calculate both hashes.
            </p>

			<form action="http://www.bibsonomy.org/BibTeXHashExample.jsp">
				<table>
					<tr>
						<th colspan="2">
							used in interhash and intrahash
						</th>
					</tr>
					<tr>
						<td>title:</td>
						<td>
							<input type="text" size="100" name="title"/>
						</td>
					</tr>
					<tr>
						<td>author:</td>
						<td>
							<input type="text" size="100" name="author"/>
						</td>
					</tr>
					<tr>
						<td>editor:</td>
						<td>
							<input type="text" size="100" name="editor"/>
						</td>
					</tr>
					<tr>
						<td>year:</td>
						<td>
							<input type="text" size="100" name="year"/>
						</td>
					</tr>
					<tr>
						<th colspan="2">used only in intrahash</th>
					</tr>
					<tr>
						<td>entrytype:</td>
						<td>
							<input type="text" size="100" name="entrytype"/>
						</td>
					</tr>
					<tr>
						<td>journal:</td>
						<td>
							<input type="text" size="100" name="journal"/>
						</td>
					</tr>
					<tr>
						<td>booktitle:</td>
						<td>
							<input type="text" size="100" name="booktitle"/>
						</td>
					</tr>
					<tr>
						<td>volume:</td>
						<td>
							<input type="text" size="100" name="volume"/>
						</td>
					</tr>
					<tr>
						<td>number:</td>
						<td>
							<input type="text" size="100" name="number"/>
						</td>
					</tr>
				</table>
				<input type="submit"/>
			</form>


			<p>If you just want to have an example to play around, follow  			
			<a href="http://www.bibsonomy.org/BibTeXHashExample.jsp?title=Tag+Recommendations+in+Folksonomies&amp;author=Robert+J%C3%A4schke+and+Leandro+Balby+Marinho+and+Andreas+Hotho+and+Lars+Schmidt-Thieme+and+Gerd+Stumme&amp;editor=Joost+N.+Kok+and+Jacek+Koronacki+and+Ramon+L%C3%B3pez+de+M%C3%A1ntaras+and+Stan+Matwin+and+Dunja+Mladenic+and+Andrzej+Skowron&amp;year=2007&amp;entrytype=inproceedings&amp;journal=&amp;booktitle=Knowledge+Discovery+in+Databases%3A+PKDD+2007%2C+11th+European+Conference+on+Principles+and+Practice+of+Knowledge+Discovery+in+Databases&amp;volume=4702&amp;number=">this link</a>.
			</p>


			
			<h4>Sourcecode</h4>
			
			<p>
			  The complete source code to compute the hashes is included in 
			  <a href="http://www.bibsonomy.org/help/downloads/org.bibsonomy.hashes_0.2.jar">org.bibsonomy.hashes_0.2.jar</a>. 
			  It includes the class <tt>org.bibsonomy.util.BibTeXHashCalculator</tt>, which contains a main method you
			  can call with <tt>java -jar org.bibsonomy.hashes_0.1.jar</tt> to see an example output and to use it as
			  starting point for browsing and understanding the source.
			</p>
			
			<p>
				The computation of the hashes is done in class <tt>org.bibsonomy.model.util.SimHash</tt>. It contains the following code to 
				compute the <em>intra</em> hash:</p> 

<source>
public static String getIntraHash(final BibTeX bibtex) {
   return StringUtils.getMD5Hash(StringUtils.removeNonNumbersOrLettersOrDotsOrSpace(bibtex.getTitle())     + " " + 
      StringUtils.removeNonNumbersOrLettersOrDotsOrSpace(bibtex.getAuthor())    + " " + 
      StringUtils.removeNonNumbersOrLettersOrDotsOrSpace(bibtex.getEditor())    + " " + 
      StringUtils.removeNonNumbersOrLettersOrDotsOrSpace(bibtex.getYear())      + " " + 
      StringUtils.removeNonNumbersOrLettersOrDotsOrSpace(bibtex.getEntrytype()) + " " + 
      StringUtils.removeNonNumbersOrLettersOrDotsOrSpace(bibtex.getJournal())   + " " + 
      StringUtils.removeNonNumbersOrLettersOrDotsOrSpace(bibtex.getBooktitle()) + " " +
      StringUtils.removeNonNumbersOrLetters(bibtex.getVolume())                 + " " +
      StringUtils.removeNonNumbersOrLetters(bibtex.getNumber())
   );
}
</source>

<p>The following code is responsible to compute the <em>inter</em> hash:</p>

<source>
public static String getInterHash(final BibTeX bibtex) {	
   if (StringUtils.removeNonNumbersOrLetters(bibtex.getAuthor()).equals("")) {
      // no author set --> take editor
      return StringUtils.getMD5Hash(getNormalizedTitle(bibtex.getTitle()) + " " +
         getNormalizedEditor(bibtex.getEditor())            + " " +
         getNormalizedYear(bibtex.getYear()));				
   }
   // author set
   return StringUtils.getMD5Hash(getNormalizedTitle(bibtex.getTitle()) + " " + 
      getNormalizedAuthor(bibtex.getAuthor())            + " " + 
      getNormalizedYear(bibtex.getYear()));
}
</source>

				<p>
					To see how the helper functions (e.g., <tt>removeNonNumbersOrLetters</tt>) work, have a look at the <a href="http://www.bibsonomy.org/help/downloads/org.bibsonomy.hashes_0.1.jar">JAR file</a>.
				</p> 
						
			</subsection>
			
			 <subsection name="Screen Scrapers for Digital Libraries">
			 
			 <p>An overview of BibSonomy's screen scrapers is given on the
			 <a href="http://www.bibsonomy.org/scraperinfo">scraperinfo</a> page. 
			 We also provide a <a href="http://scraper.bibsonomy.org/">service</a> 
			 which can be used for scraping without the need to post to BibSonomy.
			 The source code of the scrapers can be found in the <a href="http://dev.bibsonomy.org/">Maven repository</a> in the 
			 <a href="http://dev.bibsonomy.org/maven2/org/bibsonomy/bibsonomy-scraper/">bibsonomy-scraper</a> module. 
			 </p>
			 
			 
			 </subsection>
			
		</section>
	</body>
</document>
